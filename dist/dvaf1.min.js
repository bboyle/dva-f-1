/*! dva-f-1 - v1.0.0 - 2016-06-13
* https://github.com/bboyle/dva-f-1#readme
* Copyright (c) 2016 Queensland Government; Licensed BSD-3-Clause */
$(function(a){"use strict";function b(a){return/^Yes|No$/.test(a)?"Yes"===a:a}function c(b){a("#"+b).html(h[b].template(f))}function d(a,b){f[a]=f.FEMININE_GENDER.test(b)?"Woman":f.MASCULINE_GENDER.test(b)?"Man":f[a]}function e(b,c){var d=a(".h3",b);d.text(d.text().replace(/\d+/,c+1)),a("input, select, textarea",b).each(function(a,b){b.id=b.id.replace(/\d+/,c),b.name=b.name.replace(/\d+/,c)}),a("label",b).each(function(a,b){b.htmlFor=b.htmlFor.replace(/\d+/,c)}),a("button.add, button.del",b).each(function(b,d){d=a(d),d.val(c).html(d.html().replace(/\d+/,c+1))})}var f=window.dvaf1Data={selected:{},event:[{}],child:[{}],associate:[{}]};f.MASCULINE_GENDER=/(^(man|male|he|him|his)$)|father|son|brother|nephew|uncle|husband|boy/i,f.FEMININE_GENDER=/(^(her|she)$)|woman|female|mother|daughter|sister|neice|aunt|wife|girl/i;var g=a("#dvaf1-form-view"),h={"dvaf1-dfn-aggrieved":{name:"dfnAggrieved"},"dvaf1-info-aggrieved-danger":{name:"infoAggrievedDanger"},"dvaf1-info-aggrieved-privacy":{name:"infoAggrievedPrivacy"},"dvaf1-situation-relationship":{name:"situationRelationshipQuestion"},"dvaf1-aggrieved-existing-order":{name:"aggrievedExistingOrderQuestion"},"dvaf1-aggrieved-existing-order-advice":{name:"infoExistingOrder"},"dvaf1-grounds-event":{name:"repeatGroundsEvent"}};a.each(h,function(b,c){var d=a("#"+b+"-partial").remove();return d.length?(c.template=Handlebars.compile(d.html()),Handlebars.registerPartial(c.name,c.template),c):void delete h[b]}),g.on("click change",function(e){var g,h=a(e.target),i=e.target.name,j=a(e.target).val();if(!h.is("button.add, button.del")&&(/^(event|child|associate)[0-9]+\./.test(i)?(g=i.replace(/^(?:event|child|associate)([0-9]+).*$/,"$1"),i=i.split(/[0-9]+\./),f[i[0]][g]=f[i[0]][g]||{},f[i[0]][g][i[1]]=j):(f[i]=b(j),j.length&&(j=j.replace(/\s+/g,""))),h.is("select,:radio,:checkbox")))switch(h.is(":checkbox")?(f.selected[i]=f.selected[i]||{},f.selected[i][j]=e.target.checked):(f.selected[i]={},f.selected[i][j]=!0),i){case"situationParty":d("respondentGender",j);break;case"userRelationship":d("aggrievedGender",j);case"userIsAggrieved":c("dvaf1-dfn-aggrieved"),c("dvaf1-situation-relationship"),c("dvaf1-aggrieved-existing-order"),c("dvaf1-aggrieved-existing-order-advice");break;case"userDanger":c("dvaf1-info-aggrieved-danger");break;case"userPrivacy":c("dvaf1-info-aggrieved-privacy");break;case"aggrievedExistingOrderJurisdiction":c("dvaf1-aggrieved-existing-order-advice")}}),a(document).on("click","button.add",function(){var b=parseInt(this.value,10),c=f[this.name],d=a(this).closest(".section, .group");c.splice(b+1,0,{}),0===d.find("button.del").length&&d.find(".actions").append('<li><em><button type="button" class="del" name="'+this.name+'" value="0"><i class="fa fa-minus-square"></i> Remove '+this.name+" 1</button></em></li>");var g=d.clone();a("input, select, textarea",g).each(function(a,b){b.value=""}),g.insertAfter(d),b++,d.nextAll(".section").each(function(a,c){e(c,b+a)})}),a(document).on("click","button.del",function(){var b=parseInt(this.value,10),c=f[this.name];c.splice(b,1),c.length<1&&(c[0]={}),a(this).closest(".section").nextAll(".section").each(function(d,f){c.length<2&&a("button.del",f).remove(),e(f,b+d)}),a(this).closest(".section").remove()})}),$(function(){"use strict";function a(a){return a.charAt(0).toUpperCase()+a.slice(1)}function b(){return dvaf1Data.userIsAggrieved?"you":dvaf1Data.userRelationship&&"someone"!==dvaf1Data.userRelationship?"your "+dvaf1Data.userRelationship:"the aggrieved"}function c(){return"the respondent"}function d(){return a(b())}function e(a){return dvaf1Data.aggrievedNameGiven?dvaf1Data.aggrievedNameGiven+(a===!0?" (the aggrieved)":""):"the aggrieved"}function f(a){return dvaf1Data.aggrievedNameGiven?dvaf1Data.aggrievedNameGiven+(a===!0?" (the aggrieved)":""):"The aggrieved"}function g(a){return dvaf1Data.respondentNameGiven?dvaf1Data.respondentNameGiven+(a===!0?" (the respondent)":""):"the respondent"}function h(a){return dvaf1Data.respondentNameGiven?dvaf1Data.respondentNameGiven+(a===!0?" (the respondent)":""):"The respondent"}function i(){return dvaf1Data.userIsAggrieved?"your":e()+"â€™s"}function j(){return a(i())}function k(){return dvaf1Data.userIsAggrieved?"do you":dvaf1Data.aggrievedNameGiven?"does "+dvaf1Data.aggrievedNameGiven:dvaf1Data.userRelationship?"someone"===dvaf1Data.userRelationship?"do they":"does your "+dvaf1Data.userRelationship:"does the aggrieved"}function l(){return a(k())}function m(){return dvaf1Data.respondentNameGiven?"does "+dvaf1Data.respondentNameGiven:"does the respondent"}function n(){return a(m())}function o(){return dvaf1Data.userIsAggrieved?"are you":dvaf1Data.aggrievedNameGiven?"is "+dvaf1Data.aggrievedNameGiven:dvaf1Data.userRelationship?"someone"===dvaf1Data.userRelationship?"are they":"is your "+dvaf1Data.userRelationship:"is the aggrieved"}function p(){return a(o())}function q(){return dvaf1Data.respondentNameGiven?"is "+dvaf1Data.respondentNameGiven:"is the respondent"}function r(){return a(q())}function s(a,b,c,d){return dvaf1Data.FEMININE_GENDER.test(a)?b:dvaf1Data.MASCULINE_GENDER.test(a)?c:d}function t(){if(dvaf1Data.userIsAggrieved)return"I live";var a=s(dvaf1Data.aggrievedGender,"she","he","they");return"they"===a?"they live":a+" lives"}function u(a,b){if(dvaf1Data.userIsAggrieved)return"you "+a;var c=s(dvaf1Data.aggrievedGender,"she","he","they");return"they"===c?"they "+a:c+" "+b}function v(){return u("live","lives")}function w(){return u("know","knows")}function x(){return u("have","has")}function y(){return dvaf1Data.userIsAggrieved?"I need":dvaf1Data.userRelationship&&"someone"!==dvaf1Data.userRelationship?"My "+dvaf1Data.userRelationship+" needs":"The aggrieved needs"}function z(){return u("need","needs")}function A(){var a=s(dvaf1Data.respondentGender,"she","he","they");return"they"===a?"they receive":a+" receives"}function B(){return dvaf1Data.userIsAggrieved?"You want":dvaf1Data.aggrievedNameGiven?dvaf1Data.aggrievedNameGiven+" wants":"The aggrieved wants"}function C(){return a(B())}function D(){return dvaf1Data.userIsAggrieved?"me":s(dvaf1Data.aggrievedGender,"her","him","them")}function E(){return dvaf1Data.userIsAggrieved?"my":s(dvaf1Data.aggrievedGender,"her","his","their")}function F(){return dvaf1Data.userIsAggrieved===!1?dvaf1Data.aggrievedNameGiven:"you"}function G(a){return dvaf1Data.userIsAggrieved===!1?e()+(a?" (the aggrieved)":""):"you"+(a?" (the aggrieved)":"")}function H(){return dvaf1Data.userIsAggrieved===!1?s(dvaf1Data.aggrievedGender,"her","him","them"):"you"}function I(){return dvaf1Data.userIsAggrieved===!1?e()+" is":"you are"}function J(){return dvaf1Data.userIsAggrieved===!1?s(dvaf1Data.aggrievedGender,"her","his",e()):"your"}function K(){return dvaf1Data.userIsAggrieved===!1?e()+" and "+g():"we"}function L(){return a(K())}function M(){return s(dvaf1Data.respondentGender,"she","he","they")}function N(){return a(M())}Handlebars.registerHelper("theAggrieved",b),Handlebars.registerHelper("TheAggrieved",d),Handlebars.registerHelper("aggrievedName",e),Handlebars.registerHelper("AggrievedName",f),Handlebars.registerHelper("theAggrieveds",i),Handlebars.registerHelper("TheAggrieveds",j),Handlebars.registerHelper("aggrievedYou",G),Handlebars.registerHelper("aggrievedYouThem",H),Handlebars.registerHelper("aggrievedYouAre",I),Handlebars.registerHelper("aggrievedYour",J),Handlebars.registerHelper("we",K),Handlebars.registerHelper("We",L),Handlebars.registerHelper("theRespondent",c),Handlebars.registerHelper("RespondentName",h),Handlebars.registerHelper("respondentName",g),Handlebars.registerHelper("respondentTheyReceive",A),Handlebars.registerHelper("doesTheRespondent",m),Handlebars.registerHelper("DoesTheRespondent",n),Handlebars.registerHelper("IsTheRespondent",r),Handlebars.registerHelper("doesTheAggrieved",k),Handlebars.registerHelper("DoesTheAggrieved",l),Handlebars.registerHelper("isTheAggrieved",o),Handlebars.registerHelper("IsTheAggrieved",p),Handlebars.registerHelper("aggrievedILive",t),Handlebars.registerHelper("aggrievedYouHave",x),Handlebars.registerHelper("aggrievedYouLive",v),Handlebars.registerHelper("aggrievedYouKnow",w),Handlebars.registerHelper("aggrievedYouPlurals",u),Handlebars.registerHelper("aggrievedYouNeed",z),Handlebars.registerHelper("TheAggrievedINeed",y),Handlebars.registerHelper("TheAggrievedWants",C),Handlebars.registerHelper("theAggrievedWants",B),Handlebars.registerHelper("aggrievedMe",D),Handlebars.registerHelper("aggrievedMy",E),Handlebars.registerHelper("theAggrievedThey",F),Handlebars.registerHelper("TheAggrievedIs",function(){return dvaf1Data.userIsAggrieved?"You are":dvaf1Data.userRelationship?"someone"===dvaf1Data.userRelationship?"They are":"Your "+dvaf1Data.userRelationship+" is":"The aggrieved is"}),Handlebars.registerHelper("TheApplicantIs",function(){return"user"===dvaf1Data.applicationLodgedBy?"I am":"The applicant is"}),Handlebars.registerHelper("aggrievedTheir",function(){return dvaf1Data.userIsAggrieved?"your":s(dvaf1Data.aggrievedGender,"her","his","their")}),Handlebars.registerHelper("aggrievedThey",function(){return dvaf1Data.userIsAggrieved?"your":s(dvaf1Data.aggrievedGender,"she","he","they")}),Handlebars.registerHelper("aggrievedThem",function(){return dvaf1Data.userIsAggrieved?"your":s(dvaf1Data.aggrievedGender,"her","him","them")}),Handlebars.registerHelper("respondentTheir",function(){return s(dvaf1Data.respondentGender,"her","his","their")}),Handlebars.registerHelper("respondentThey",M),Handlebars.registerHelper("RespondentThey",N),Handlebars.registerHelper("respondentThem",function(){return s(dvaf1Data.respondentGender,"her","him","them")}),Handlebars.registerHelper("respondentTheyKnow",function(){return"they know"}),Handlebars.registerHelper("plus1",function(a){return parseFloat(a)+1}),Handlebars.registerHelper("theChildren",function(){return"the "+(1===dvaf1Data.child.length?"child":"children")}),Handlebars.registerHelper("theAggrievedsKids",function(){return i()+" "+dvaf1Data.child.length===1?"kid":"kids"}),Handlebars.registerHelper("theAssociatesNeed",function(){return"the "+dvaf1Data.associate.length===1?"associate needs":"associates need"})}),$(function(a){"use strict";function b(b,c){return"*"===c.values&&(c.values=a.map(a(b.find("form").get(0).elements[c.name]).find("option"),function(a){return a.value?a.value:null})),c}function c(){e.trigger("x-height-change")}function d(d){var j=g[h[d]];i=d,e.html(a(j.template(dvaf1Data))),j.relevance&&a.each(j.relevance,function(c,d){a.isArray(d)?a.each(d,function(a,d){e.find(c).relevance("relevantWhen",b(e,d))}):e.find(c).relevance("relevantWhen",b(e,d))}),a("html, body").scrollTop(f.top).scrollLeft(f.left),c()}var e=a("#dvaf1-form-view"),f=e.offset(),g={"dvaf1-preamble-template":{relevance:{"#dvaf1-legal-advice":{name:"legalAdvice",value:"How"}}},"dvaf1-situation-template":{relevance:{"#dvaf1-dfn-aggrieved":[{name:"userIsAggrieved",value:"Yes"},{name:"userRelationship",values:"*"}],"#dvaf1-user-relationship-placeholder":{name:"userIsAggrieved",value:"No",negate:!0},"#dvaf1-user-relationship":{name:"userIsAggrieved",value:"No"},"#dvaf1-aggrieved-danger-question":{name:"userIsAggrieved",value:"Yes"},"#dvaf1-aggrieved-privacy-question":{name:"userDanger",values:["Yes","Maybe","No"]},"#dvaf1-info-aggrieved-danger":{name:"userDanger",values:["Yes","Maybe"]},"#dvaf1-info-aggrieved-privacy":{name:"userPrivacy",values:["No","Not sure"]},"#dvaf1-situation-relationship":[{name:"userPrivacy",value:"Yes"},{name:"userRelationship",values:"*"}],"#dvaf1-aggrieved-existing-order-jurisdiction":{name:"aggrievedExistingOrder",value:"Yes"},"#dvaf1-aggrieved-existing-order-advice":{name:"aggrievedExistingOrderJurisdiction",values:["ACT","NSW","NT","QLD","SA","Tas","Vic","WA","NZ","Other"]}}},"dvaf1-aggrieved-basic-template":{},"dvaf1-respondent-basic-template":{},"dvaf1-relationship-template":{relevance:{"#dvaf1-relationship-commercialcare":{name:"aggrievedRelationship",value:"CommercialCare"},"#dvaf1-relationship-intimate":{name:"aggrievedRelationship",value:"Intimate"},"#dvaf1-relationship-intimate-couple":{name:"aggrievedRelationshipType",values:["Couple","FormerCouple"]},"#dvaf1-relationship-family":{name:"aggrievedRelationship",value:"Family"},"#dvaf1-relationship-informalcare":{name:"aggrievedRelationship",value:"InformalCare"}}},"dvaf1-grounds-template":{relevance:{"#dvaf1-weapon-other-question":{name:"respondentWeaponThreat",value:"No"},"#dvaf1-weapon-details":{name:"respondentWeaponThreat",value:"Yes"},"#dvaf1-weapon-details2":{name:"respondentWeaponThreat2",value:"Yes"}}},"dvaf1-conditions-template":{},"dvaf1-urgent-template":{relevance:{"#dvaf1-tpo-info":[{name:"abuseRecent",value:"No"},{name:"abuseImmediateFear",value:"No"},{name:"abuseApplicationRetaliation",value:"No"}],"#dvaf1-tpo-grounds":{name:"tpoApply",value:"Yes"}}},"dvaf1-aggrieved-template":{relevance:{"#dvaf1-aggrieved-interpreter-language":{name:"aggrievedRequiresInterpreter",value:"Yes"},"#dvaf1-aggrieved-disability-description":{name:"aggrievedHasDisability",value:"Yes"},"#dvaf1-aggrieved-parent-details":{name:"aggrievedUnder18",value:"Yes"}}},"dvaf1-children-template":{},"dvaf1-associates-template":{},"dvaf1-respondent-template":{relevance:{"#dvaf1-respondent-interpreter-language":{name:"respondentRequiresInterpreter",value:"Yes"},"#dvaf1-respondent-disability-description":{name:"respondentHasDisability",value:"Yes"},"#dvaf1-respondent-parent-details":{name:"respondentUnder18",value:"Yes"}}},"dvaf1-orders-template":{relevance:{"#dvfa1-orders-existing":{name:"ordersExist",value:"Yes"},"#dvfa1-orders-existing-other":{name:"ordersOther",values:["Current","Past"]},"#dvaf1-orders-cross-application-status":{name:"ordersCrossApplicationInProgress",value:"Yes"}}},"dvaf1-applicant-template":{relevance:{"#dvaf1-applicant-type":{name:"applicationLodgedBy",values:["user","thirdParty"]},"#dvaf1-applicant-type-details":{name:"applicationLodgedBy",values:["user","thirdParty"]},"#dvaf1-application-partA":{name:"applicantPart",value:"A"},"#dvaf1-application-partB":{name:"applicantPart",value:"B"},"#dvaf1-application-partD":{name:"applicantPart",value:"D"},"#dvaf1-application-authorisation-received":{name:"applicantAuthorisedInWriting",value:"No"},"#dvaf1-application-partB-other":{name:"applicantActingAs",value:"Other"}}},"dvaf1-court-template":{relevance:{"#dvaf1-court-safety-info":{name:"aggrievedCourtSafetyConcern",value:"Yes"},"#dvaf1-court-safety-attending":{name:"aggrievedCourtSafetyConcern",value:"Yes"},"#dvaf1-court-safety-leaving":{name:"aggrievedCourtSafetyConcern",value:"Yes"}}},"dvaf1-download-template":{}},h=[],i=0;a.each(g,function(b,c){var d=a("#"+b).remove();return d.length?(c.template=Handlebars.compile(d.html()),h.push(b),c):void delete g[b]}),e.on("relevant irrelevant",c),e.on("submit",function(a){"POST"!==a.target.method.toUpperCase()&&(a.preventDefault(),h[i+1]?d(i+1):a.target.action&&window.location.replace(a.target.action))}),a(document).on("click","a",function(a){var b=a.target.href.split("#");b.length>1&&/^dvaf1/.test(b[1])&&(b=h.indexOf(b[1]),-1!==b&&(a.preventDefault(),d(b)))}),d(i)});