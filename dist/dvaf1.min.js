/*! dva-f-1 - v1.0.0 - 2016-04-26
* https://github.com/bboyle/dva-f-1#readme
* Copyright (c) 2016 Queensland Government; Licensed BSD-3-Clause */
$(function(a){"use strict";function b(a){return/^Yes|No$/.test(a)?"Yes"===a:a}function c(b){a("#"+b).html(f[b].template(d))}var d=window.dvaf1Data={selected:{}};d.MASCULINE_GENDER=/^(man|male|father|son|brother|nephew|uncle|husband|boy|boyfriend|him|his|he)$/i,d.FEMININE_GENDER=/^(woman|female|mother|daughter|sister|neice|aunt|wife|girl|girlfriend|her|she)$/i;var e=a("#dvaf1-form-view"),f={"dvaf1-dfn-aggrieved":{name:"dfnAggrieved"},"dvaf1-info-aggrieved-danger":{name:"infoAggrievedDanger"},"dvaf1-info-aggrieved-privacy":{name:"infoAggrievedPrivacy"},"dvaf1-aggrieved-existing-order":{name:"aggrievedExistingOrderQuestion"},"dvaf1-aggrieved-existing-order-advice":{name:"infoExistingOrder"}};a.each(f,function(b,c){var d=a("#"+b+"-partial").remove();return d.length?(c.template=Handlebars.compile(d.html()),Handlebars.registerPartial(c.name,c.template),c):void delete f[b]}),e.on("click change",function(e){var f=a(e.target),g=e.target.name,h=a(e.target).val();if(d[g]=b(h),h=h.replace(/\s+/g,""),f.is("select,:radio,:checkbox"))switch(f.is(":checkbox")?d.selected[g][h]=e.target.checked:(d.selected[g]={},d.selected[g][h]=!0),"userRelationship"===g&&(d.aggrievedGender=d.FEMININE_GENDER.test(h)?"Woman":d.MASCULINE_GENDER.test(h)?"Man":d.aggrievedGender),g){case"userIsAggrieved":case"userRelationship":c("dvaf1-dfn-aggrieved"),c("dvaf1-aggrieved-existing-order-advice");break;case"userDanger":c("dvaf1-info-aggrieved-danger");break;case"userPrivacy":c("dvaf1-info-aggrieved-privacy");break;case"aggrievedExistingOrderJurisdiction":c("dvaf1-aggrieved-existing-order-advice")}})}),$(function(){"use strict";function a(a){return a.charAt(0).toUpperCase()+a.slice(1)}function b(){return dvaf1Data.userIsAggrieved?"you":dvaf1Data.userRelationship&&"someone"!==dvaf1Data.userRelationship?"your "+dvaf1Data.userRelationship:"the aggrieved"}function c(){return a(b())}function d(){return dvaf1Data.userIsAggrieved?"do you":dvaf1Data.aggrievedNameGiven?"does "+dvaf1Data.aggrievedNameGiven:dvaf1Data.userRelationship?"someone"===dvaf1Data.userRelationship?"do they":"does your "+dvaf1Data.userRelationship:"does the aggrieved"}function e(){return a(d())}function f(a,b,c,d){return dvaf1Data.FEMININE_GENDER.test(a)?b:dvaf1Data.MASCULINE_GENDER.test(a)?c:d}Handlebars.registerHelper("theAggrieved",b),Handlebars.registerHelper("TheAggrieved",c),Handlebars.registerHelper("doesTheAggrieved",d),Handlebars.registerHelper("DoesTheAggrieved",e),Handlebars.registerHelper("TheAggrievedIs",function(){return dvaf1Data.userIsAggrieved?"You are":dvaf1Data.userRelationship?"someone"===dvaf1Data.userRelationship?"They are":"Your "+dvaf1Data.userRelationship+" is":"The aggrieved is"}),Handlebars.registerHelper("aggrievedTheir",function(){return dvaf1Data.userIsAggrieved?"your":f(dvaf1Data.aggrievedGender,"her","his","their")})}),$(function(a){"use strict";function b(b,c){return"*"===c.values&&(c.values=a.map(a(b.find("form").get(0).elements[c.name]).find("option"),function(a){return a.value?a.value:null})),c}function c(){e.trigger("x-height-change")}function d(d){var j=g[h[d]];i=d,e.html(a(j.template(dvaf1Data))),j.relevance&&a.each(j.relevance,function(c,d){a.isArray(d)?a.each(d,function(a,d){e.find(c).relevance("relevantWhen",b(e,d))}):e.find(c).relevance("relevantWhen",b(e,d))}),a("html, body").scrollTop(f.top).scrollLeft(f.left),c()}var e=a("#dvaf1-form-view"),f=e.offset(),g={"dvaf1-preamble-template":{relevance:{"#dvaf1-legal-advice":{name:"legalAdvice",value:"How do I get legal advice?"}}},"dvaf1-situation-template":{relevance:{"#dvaf1-dfn-aggrieved":[{name:"userIsAggrieved",value:"Yes"},{name:"userRelationship",values:"*"}],"#dvaf1-user-relationship-placeholder":{name:"userIsAggrieved",value:"No",negate:!0},"#dvaf1-user-relationship":{name:"userIsAggrieved",value:"No"},"#dvaf1-aggrieved-danger-question":{name:"userIsAggrieved",value:"Yes"},"#dvaf1-aggrieved-privacy-question":{name:"userIsAggrieved",value:"Yes"},"#dvaf1-info-aggrieved-danger":{name:"userDanger",values:["Yes","Maybe"]},"#dvaf1-info-aggrieved-privacy":{name:"userPrivacy",values:["No","Not sure"]},"#dvaf1-aggrieved-existing-order-jurisdiction":{name:"aggrievedExistingOrder",value:"Yes"},"#dvaf1-aggrieved-existing-order-advice":{name:"aggrievedExistingOrderJurisdiction",values:["ACT","NSW","NT","QLD","SA","Tas","Vic","WA","NZ","Other"]}}},"dvaf1-aggrieved-basic-template":{},"dvaf1-respondent-basic-template":{},"dvaf1-relationship-template":{},"dvaf1-grounds-template":{},"dvaf1-conditions-template":{},"dvaf1-urgent-template":{},"dvaf1-aggrieved-template":{},"dvaf1-children-template":{},"dvaf1-associates-template":{},"dvaf1-respondent-template":{},"dvaf1-orders-template":{},"dvaf1-applicant-template":{},"dvaf1-court-template":{},"dvaf1-download-template":{}},h=[],i=0;a.each(g,function(b,c){var d=a("#"+b).remove();return d.length?(c.template=Handlebars.compile(d.html()),h.push(b),c):void delete g[b]}),e.on("relevant irrelevant",c),e.on("submit",function(a){a.preventDefault(),h[i+1]?d(i+1):a.target.action&&window.location.replace(a.target.action)}),a(document).on("click","a",function(a){var b=a.target.href.split("#");b.length>1&&/^dvaf1/.test(b[1])&&(b=h.indexOf(b[1]),-1!==b&&(a.preventDefault(),d(b)))}),d(i)});