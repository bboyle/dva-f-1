/*! dva-f-1 - v1.0.0 - 2016-05-02
* https://github.com/bboyle/dva-f-1#readme
* Copyright (c) 2016 Queensland Government; Licensed BSD-3-Clause */
$(function(a){"use strict";function b(a){return/^Yes|No$/.test(a)?"Yes"===a:a}function c(b){a("#"+b).html(g[b].template(e))}function d(a,b){e[a]=e.FEMININE_GENDER.test(b)?"Woman":e.MASCULINE_GENDER.test(b)?"Man":e[a]}var e=window.dvaf1Data={selected:{}};e.MASCULINE_GENDER=/(^(man|male|he|him|his)$)|father|son|brother|nephew|uncle|husband|boy/i,e.FEMININE_GENDER=/(^(her|she)$)|woman|female|mother|daughter|sister|neice|aunt|wife|girl/i;var f=a("#dvaf1-form-view"),g={"dvaf1-dfn-aggrieved":{name:"dfnAggrieved"},"dvaf1-info-aggrieved-danger":{name:"infoAggrievedDanger"},"dvaf1-info-aggrieved-privacy":{name:"infoAggrievedPrivacy"},"dvaf1-situation-relationship":{name:"situationRelationshipQuestion"},"dvaf1-aggrieved-existing-order":{name:"aggrievedExistingOrderQuestion"},"dvaf1-aggrieved-existing-order-advice":{name:"infoExistingOrder"}};a.each(g,function(b,c){var d=a("#"+b+"-partial").remove();return d.length?(c.template=Handlebars.compile(d.html()),Handlebars.registerPartial(c.name,c.template),c):void delete g[b]}),f.on("click change",function(f){var g=a(f.target),h=f.target.name,i=a(f.target).val();if(e[h]=b(i),i.length&&(i=i.replace(/\s+/g,"")),g.is("select,:radio,:checkbox"))switch(g.is(":checkbox")?e.selected[h][i]=f.target.checked:(e.selected[h]={},e.selected[h][i]=!0),h){case"situationParty":d("respondentGender",i);break;case"userRelationship":d("aggrievedGender",i);case"userIsAggrieved":c("dvaf1-dfn-aggrieved"),c("dvaf1-situation-relationship"),c("dvaf1-aggrieved-existing-order"),c("dvaf1-aggrieved-existing-order-advice");break;case"userDanger":c("dvaf1-info-aggrieved-danger");break;case"userPrivacy":c("dvaf1-info-aggrieved-privacy");break;case"aggrievedExistingOrderJurisdiction":c("dvaf1-aggrieved-existing-order-advice")}})}),$(function(){"use strict";function a(a){return a.charAt(0).toUpperCase()+a.slice(1)}function b(){return dvaf1Data.userIsAggrieved?"you":dvaf1Data.userRelationship&&"someone"!==dvaf1Data.userRelationship?"your "+dvaf1Data.userRelationship:"the aggrieved"}function c(){return"the respondent"}function d(){return a(b())}function e(){return dvaf1Data.userIsAggrieved?"do you":dvaf1Data.aggrievedNameGiven?"does "+dvaf1Data.aggrievedNameGiven:dvaf1Data.userRelationship?"someone"===dvaf1Data.userRelationship?"do they":"does your "+dvaf1Data.userRelationship:"does the aggrieved"}function f(){return a(e())}function g(a,b,c,d){return dvaf1Data.FEMININE_GENDER.test(a)?b:dvaf1Data.MASCULINE_GENDER.test(a)?c:d}function h(){return dvaf1Data.userIsAggrieved?"I need":dvaf1Data.userRelationship&&"someone"!==dvaf1Data.userRelationship?"My "+dvaf1Data.userRelationship+" needs":"The aggrieved needs"}function i(){return dvaf1Data.userIsAggrieved?"my":g(dvaf1Data.aggrievedGender,"her","his","their")}function j(){return dvaf1Data.userIsAggrieved===!1?dvaf1Data.aggrievedNameGiven:"you"}function k(){return dvaf1Data.userIsAggrieved===!1?dvaf1Data.aggrievedNameGiven:"you"}function l(){return dvaf1Data.userIsAggrieved===!1?dvaf1Data.aggrievedNameGiven:"your"}function m(a){return dvaf1Data.respondentNameGiven?dvaf1Data.respondentNameGiven+(a===!0?" (the respondent)":""):"the respondent"}function n(a){return dvaf1Data.respondentNameGiven?dvaf1Data.respondentNameGiven+(a===!0?" (the respondent)":""):"The respondent"}Handlebars.registerHelper("theAggrieved",b),Handlebars.registerHelper("TheAggrieved",d),Handlebars.registerHelper("aggrievedYou",k),Handlebars.registerHelper("aggrievedYour",l),Handlebars.registerHelper("theRespondent",c),Handlebars.registerHelper("RespondentName",n),Handlebars.registerHelper("respondentName",m),Handlebars.registerHelper("doesTheAggrieved",e),Handlebars.registerHelper("DoesTheAggrieved",f),Handlebars.registerHelper("TheAggrievedINeed",h),Handlebars.registerHelper("theAggrievedMy",i),Handlebars.registerHelper("theAggrievedThey",j),Handlebars.registerHelper("TheAggrievedIs",function(){return dvaf1Data.userIsAggrieved?"You are":dvaf1Data.userRelationship?"someone"===dvaf1Data.userRelationship?"They are":"Your "+dvaf1Data.userRelationship+" is":"The aggrieved is"}),Handlebars.registerHelper("aggrievedTheir",function(){return dvaf1Data.userIsAggrieved?"your":g(dvaf1Data.aggrievedGender,"her","his","their")}),Handlebars.registerHelper("respondentTheyKnow",function(){return"they know"})}),$(function(a){"use strict";function b(b,c){return"*"===c.values&&(c.values=a.map(a(b.find("form").get(0).elements[c.name]).find("option"),function(a){return a.value?a.value:null})),c}function c(){e.trigger("x-height-change")}function d(d){var j=g[h[d]];i=d,e.html(a(j.template(dvaf1Data))),j.relevance&&a.each(j.relevance,function(c,d){a.isArray(d)?a.each(d,function(a,d){e.find(c).relevance("relevantWhen",b(e,d))}):e.find(c).relevance("relevantWhen",b(e,d))}),a("html, body").scrollTop(f.top).scrollLeft(f.left),c()}var e=a("#dvaf1-form-view"),f=e.offset(),g={"dvaf1-preamble-template":{relevance:{"#dvaf1-legal-advice":{name:"legalAdvice",value:"How"}}},"dvaf1-situation-template":{relevance:{"#dvaf1-dfn-aggrieved":[{name:"userIsAggrieved",value:"Yes"},{name:"userRelationship",values:"*"}],"#dvaf1-user-relationship-placeholder":{name:"userIsAggrieved",value:"No",negate:!0},"#dvaf1-user-relationship":{name:"userIsAggrieved",value:"No"},"#dvaf1-aggrieved-danger-question":{name:"userIsAggrieved",value:"Yes"},"#dvaf1-aggrieved-privacy-question":{name:"userDanger",values:["Yes","Maybe","No"]},"#dvaf1-info-aggrieved-danger":{name:"userDanger",values:["Yes","Maybe"]},"#dvaf1-info-aggrieved-privacy":{name:"userPrivacy",values:["No","Not sure"]},"#dvaf1-situation-relationship":[{name:"userPrivacy",value:"Yes"},{name:"userRelationship",values:"*"}],"#dvaf1-aggrieved-existing-order-jurisdiction":{name:"aggrievedExistingOrder",value:"Yes"},"#dvaf1-aggrieved-existing-order-advice":{name:"aggrievedExistingOrderJurisdiction",values:["ACT","NSW","NT","QLD","SA","Tas","Vic","WA","NZ","Other"]}}},"dvaf1-aggrieved-basic-template":{},"dvaf1-respondent-basic-template":{},"dvaf1-relationship-template":{},"dvaf1-grounds-template":{},"dvaf1-conditions-template":{},"dvaf1-urgent-template":{},"dvaf1-aggrieved-template":{},"dvaf1-children-template":{},"dvaf1-associates-template":{},"dvaf1-respondent-template":{},"dvaf1-orders-template":{},"dvaf1-applicant-template":{},"dvaf1-court-template":{relevance:{"#dvaf1-court-safety-info":{name:"aggrievedCourtSafetyConcern",value:"Yes"},"#dvaf1-court-safety-attending":{name:"aggrievedCourtSafetyConcern",value:"Yes"},"#dvaf1-court-safety-leaving":{name:"aggrievedCourtSafetyConcern",value:"Yes"}}},"dvaf1-download-template":{}},h=[],i=0;a.each(g,function(b,c){var d=a("#"+b).remove();return d.length?(c.template=Handlebars.compile(d.html()),h.push(b),c):void delete g[b]}),e.on("relevant irrelevant",c),e.on("submit",function(a){"POST"!==a.target.method.toUpperCase()&&(a.preventDefault(),h[i+1]?d(i+1):a.target.action&&window.location.replace(a.target.action))}),a(document).on("click","a",function(a){var b=a.target.href.split("#");b.length>1&&/^dvaf1/.test(b[1])&&(b=h.indexOf(b[1]),-1!==b&&(a.preventDefault(),d(b)))}),d(i)});